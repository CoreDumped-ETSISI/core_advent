<div >
    <%= link_to "Volver a problemas", problems_by_year_path(@year)%>

  <div >
    <h2>Rankings para <%= @year %></h2>
  </div>

  <% if @ranking.empty? %>
    <div >
      <p>No hay datos para el año <%= @year %>.</p>
    </div>
  <% else %>
    <div >
      <table>
        <thead>
          <tr>
            <th>Posición</th>
            <th>Nombre de Usuario</th>
            <th>Problemas Completados</th>
            <th>Tiempo total</th>
            <th>Tiempo medio por problema</th>
          </tr>
        </thead>
        <tbody>
          <% @ranking.each do |entry| %>
            <tr >
              <td >
                <span >
                  <%= entry[:position] %>
                </span>
              </td>
              <td >
                <strong><%= entry[:user] %></strong>
              </td>
              <td >
                <span ><%= entry[:problems_completed] %></span>
              </td>
              <td >
                <%= format_duration(entry[:total_time_seconds]) %>
              </td>
              <td >
                <%= format_duration(entry[:average_time_per_problem]) %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <div >
      <div >
        <h3>Participantes Totales</h3>
        <p><%= @ranking.size %></p>
      </div>
      <div >
        <h3>Total de problemas Completados</h3>
        <p><%= @ranking.sum { |r| r[:problems_completed] } %></p>
      </div>
      <div >
        <h3>Media de problemas por usuario</h3>
        <p><%= (@ranking.sum { |r| r[:problems_completed] }.to_f / @ranking.size).round(1) %></p>
      </div>
    </div>
  <% end %>
</div>